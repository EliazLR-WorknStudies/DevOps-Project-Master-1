- name: Start the traefik container
  ansible.builtin.docker_container:
    name: traefik
    image: traefik
    ports:
      - "80:80"
      - "8080:8080"
      - "443:443"
    volumes:
      - "/var/run/docker.sock:/var/run/docker.sock"
    command: --api.insecure=true --providers.docker
    restart_policy: always
    state: started
  become: true

- name: Start the test traefik container
  ansible.builtin.docker_container:
    name: test
    image: traefik/whoami
    restart_policy: always
    state: started
    labels: traefik.http.routers.whoami.rule="Host(`whoami.docker.localhost`)"
  become: true
